"frmST5 As screen.'autoLayout_HeaderFooter_ver1.0'":
    OnVisible: |-
        =Reset(ddlNavigateST5);
        UpdateContext({varValidationValue:0});
        UpdateContext({varReworkchange:0})

    ScreenContainerST5 As groupContainer.verticalAutoLayoutContainer:
        Fill: =RGBA(245, 245, 245, 1)
        Height: =Parent.Height
        LayoutAlignItems: =LayoutAlignItems.Stretch
        LayoutDirection: =LayoutDirection.Vertical
        LayoutGap: =16
        LayoutMode: =LayoutMode.Auto
        PaddingBottom: =16
        PaddingLeft: =16
        PaddingRight: =16
        PaddingTop: =16
        Width: =Parent.Width
        ZIndex: =1

        HeaderContainerST5 As groupContainer.horizontalAutoLayoutContainer:
            Fill: =RGBA(39, 113, 194, 1)
            FillPortions: =0
            Height: =75
            LayoutMinHeight: =100
            LayoutMinWidth: =250
            LayoutMode: =LayoutMode.Auto
            RadiusBottomLeft: =8
            RadiusBottomRight: =8
            RadiusTopLeft: =8
            RadiusTopRight: =8
            ZIndex: =2

            headerST5 As groupContainer.manualLayoutContainer:
                LayoutMinHeight: =75
                LayoutMinWidth: =250
                ZIndex: =1

                imgUserST5 As image:
                    Height: =60
                    Image: =User().Image
                    PaddingRight: =0.00
                    PaddingTop: =0.00
                    RadiusBottomLeft: =25
                    RadiusBottomRight: =25
                    RadiusTopLeft: =25
                    RadiusTopRight: =25
                    Width: =60
                    X: =1080
                    Y: =7.5
                    ZIndex: =1

                lblUserNameST5 As label:
                    Align: =Align.Right
                    Font: =Font.Verdana
                    FontWeight: =FontWeight.Semibold
                    Height: =25
                    PaddingRight: =4.50
                    PaddingTop: =4.50
                    Size: =12
                    Text: ="Welcome, " & varUser.User_Name
                    Width: =300
                    X: =770
                    Y: =25
                    ZIndex: =2

                imgCompanyLogoST5 As image:
                    BorderColor: =RGBA(0, 0, 0, 0)
                    BorderStyle: =BorderStyle.None
                    BorderThickness: =2
                    DisabledBorderColor: =RGBA(0, 0, 0, 0)
                    DisabledFill: =RGBA(0, 0, 0, 0)
                    Fill: =RGBA(255, 255, 255, 1)
                    FocusedBorderThickness: =4
                    Height: =40
                    HoverBorderColor: =RGBA(0, 0, 0, 0)
                    HoverFill: =RGBA(0, 0, 0, 0)
                    Image: =Harsha_logo_small
                    ImagePosition: =ImagePosition.Center
                    OnSelect: =Set(varOpenMenu,!varOpenMenu)
                    PaddingRight: =0.00
                    PaddingTop: =0.00
                    PressedBorderColor: =RGBA(0, 0, 0, 0)
                    PressedFill: =RGBA(0, 0, 0, 0)
                    Width: =125
                    X: =17.5
                    Y: =17.5
                    ZIndex: =3

                lblTitleST5 As label:
                    Align: =Align.Center
                    Color: =RGBA(255, 255, 255, 1)
                    Font: =Font.'Segoe UI'
                    FontWeight: =FontWeight.Semibold
                    PaddingBottom: =0
                    PaddingLeft: =0
                    PaddingRight: =0.00
                    PaddingTop: =0.00
                    Size: =20
                    Text: ="Engineering Change Note "
                    Width: =350
                    X: =(Parent.Width-Self.Width)/2
                    Y: =5
                    ZIndex: =4

                lblSubTitleST5 As label:
                    Align: =Align.Center
                    Color: =RGBA(214, 221, 224, 1)
                    Font: =Font.'Segoe UI'
                    FontWeight: =FontWeight.Semibold
                    Height: =30
                    LineHeight: =1
                    PaddingBottom: =0
                    PaddingLeft: =0
                    PaddingRight: =0.00
                    PaddingTop: =0.00
                    Size: =15
                    Text: ="Stage - 5"
                    Width: =350
                    X: =(Parent.Width-Self.Width)/2
                    Y: =45
                    ZIndex: =6

                btnExitST5 As Button:
                    Align: =Align.Justify
                    Appearance: ='ButtonCanvas.Appearance'.Primary
                    BasePaletteColor: =
                    BorderColor: =RGBA(255, 255, 255, 1)
                    BorderStyle: =BorderStyle.Solid
                    BorderThickness: =0
                    DisplayMode: =DisplayMode.Edit
                    Font: =Font.'Segoe UI'
                    FontSize: =40
                    FontStrikethrough: =false
                    Height: =60
                    Icon: ="ArrowExit"
                    IconStyle: ='ButtonCanvas.IconStyle'.Filled
                    Layout: ='ButtonCanvas.Layout'.IconOnly
                    OnSelect: |-
                        =//Exit();
                        //Set(varUser, Blank());
                        //Clear(colStageIDs);
                        //Navigate(frmLogin,ScreenTransition.CoverRight)
                        UpdateContext({varLogoutPopup:1});
                    Text: =
                    VerticalAlign: =VerticalAlign.Middle
                    Width: =40
                    X: =1150
                    Y: =7
                    ZIndex: =7

                lblUserRoleST5 As label:
                    Align: =Align.Right
                    Font: =Font.Verdana
                    FontWeight: =FontWeight.Semibold
                    Height: =25
                    PaddingRight: =4.50
                    PaddingTop: =4.50
                    Size: =12
                    Text: ="User Role"
                    Visible: =false
                    Width: =300
                    X: =770
                    Y: =47
                    ZIndex: =8

        MainContainerST5 As groupContainer.verticalAutoLayoutContainer:
            Fill: =RGBA(255, 255, 255, 1)
            LayoutDirection: =LayoutDirection.Vertical
            LayoutMinHeight: =100
            LayoutMinWidth: =250
            LayoutMode: =LayoutMode.Auto
            RadiusBottomLeft: =8
            RadiusBottomRight: =8
            RadiusTopLeft: =8
            RadiusTopRight: =8
            ZIndex: =3

            ctnListST2_3 As groupContainer.manualLayoutContainer:
                BorderThickness: =1
                DropShadow: =DropShadow.Regular
                Fill: =RGBA(255, 255, 255, 1)
                FillPortions: =0
                Height: =90
                LayoutMinHeight: =100
                LayoutMinWidth: =250
                PaddingRight: =0.00
                PaddingTop: =0.00
                RadiusBottomLeft: =0
                RadiusBottomRight: =0
                RadiusTopLeft: =0
                RadiusTopRight: =0
                Width: =927
                Y: =footer_2.Height
                ZIndex: =1

                lblFICodeST2_3 As label:
                    FontWeight: =FontWeight.Bold
                    Height: =30
                    Text: |-
                        ="FI Code:"
                    Width: =80
                    X: =365
                    Y: =8
                    ZIndex: =11

                txtFICodeST2_3 As text:
                    Default: |-
                        =varSelectedECN.ES001_FICode
                        //txtFICodeST1.Text
                    DisabledColor: =Color.Black
                    DisplayMode: =DisplayMode.Disabled
                    Height: =28
                    LineHeight: =1
                    Mode: =TextMode.MultiLine
                    PaddingBottom: =0
                    PaddingLeft: =5
                    Reset: =true
                    Width: =100
                    X: =445
                    Y: =10
                    ZIndex: =12

                lblPartNoST2_3 As label:
                    FontWeight: =FontWeight.Bold
                    Height: =30
                    Text: |-
                        ="Part No:"
                    Width: =85
                    X: =572
                    Y: =8
                    ZIndex: =13

                txtPartNoST2_3 As text:
                    Default: |-
                        =varSelectedECN.ES001_PartNumber
                        //txtPartNoST1.Text
                    DisabledColor: =Color.Black
                    DisplayMode: =DisplayMode.Disabled
                    Height: =28
                    LineHeight: =1
                    Mode: =TextMode.MultiLine
                    PaddingBottom: =0
                    Reset: =true
                    Width: =150
                    X: =657
                    Y: =10
                    ZIndex: =14

                lblNDNST2_3 As label:
                    FontWeight: =FontWeight.Bold
                    Height: =30
                    Text: |-
                        ="New Drawing Number:"
                    Width: =210
                    X: =10
                    Y: =45
                    ZIndex: =15

                txtNDNST2_3 As text:
                    Default: |-
                        =varSelectedECN.ES001_NewDrawingNumber
                        //txtNDNST1.Text
                    DisabledColor: =Color.Black
                    DisplayMode: =DisplayMode.Disabled
                    Height: =28
                    LineHeight: =1
                    Mode: =TextMode.MultiLine
                    PaddingBottom: =0
                    PaddingLeft: =5
                    Reset: =true
                    Width: =250
                    X: =220
                    Y: =45
                    ZIndex: =16

                txtNDN_RVDST2_3 As text:
                    Default: |-
                        =varSelectedECN.ES001_NewDrawingRevision
                        //txtNDN_RVDST1.Text
                    DisabledColor: =Color.Black
                    DisplayMode: =DisplayMode.Disabled
                    Height: =28
                    LineHeight: =1
                    Mode: =TextMode.MultiLine
                    PaddingBottom: =0
                    PaddingLeft: =5
                    Reset: =true
                    Width: =250
                    X: =925
                    Y: =45
                    ZIndex: =18

                lblCustomerST2_3 As label:
                    FontWeight: =FontWeight.Bold
                    Height: =32
                    PaddingRight: =4.50
                    PaddingTop: =4.50
                    Text: |-
                        ="Customer:"
                    Width: =118
                    X: =807
                    Y: =8
                    ZIndex: =19

                txtCustomerST2_3 As text:
                    Default: |-
                        =varSelectedECN.ES001_Customer.Value
                        //ddlCustomerST1.SelectedText.Value
                    DisabledColor: =Color.Black
                    DisplayMode: =DisplayMode.Disabled
                    Height: =28
                    LineHeight: =1
                    Mode: =TextMode.MultiLine
                    PaddingBottom: =0
                    Reset: =true
                    Width: =250
                    X: =925
                    Y: =10
                    ZIndex: =20

                lblECNNoST2_3 As label:
                    Align: =Align.Justify
                    FontWeight: =FontWeight.Bold
                    Height: =28
                    Text: |-
                        ="ECN No:"
                    Width: =95
                    X: =10
                    Y: =10
                    ZIndex: =21

                txtECNNoST2_3 As text:
                    Default: |-
                        =varSelectedECN.ES001_ECNReference
                        //txtFICodeST1.Text
                    DisabledColor: =Color.Black
                    DisplayMode: =DisplayMode.Disabled
                    Height: =28
                    LineHeight: =1
                    Mode: =TextMode.MultiLine
                    PaddingBottom: =0
                    PaddingLeft: =5
                    Reset: =true
                    Width: =250
                    X: =90
                    Y: =10
                    ZIndex: =22

                lblNDN_RVDST2_3 As label:
                    FontWeight: =FontWeight.Bold
                    Height: =30
                    Text: |-
                        ="New Drawing Revision/Version and Date:"
                    Width: =380
                    X: =542
                    Y: =45
                    ZIndex: =23

            ctrDetailsST5 As groupContainer.manualLayoutContainer:
                LayoutMinHeight: =100
                LayoutMinWidth: =250
                ZIndex: =2

                rectDetailST5 As rectangle:
                    BorderThickness: =1
                    Fill: =RGBA(0, 0, 0, 0)
                    Height: =240
                    Width: =1165
                    X: =13
                    Y: =40
                    ZIndex: =1

                lblDescST5 As label:
                    Align: =Align.Center
                    BorderThickness: =1
                    Color: =RGBA(255, 255, 255, 1)
                    Fill: =RGBA(71, 158, 245, 1)
                    Height: =60
                    Text: ="Applicable stages (Tick)"
                    Width: =550
                    X: =13
                    Y: =40
                    ZIndex: =2

                lblYesNoST5 As label:
                    Align: =Align.Center
                    BorderThickness: =1
                    Color: =RGBA(255, 255, 255, 1)
                    Fill: =RGBA(71, 158, 245, 1)
                    Height: =60
                    Text: ="Yes/No"
                    Width: =100
                    X: =563
                    Y: =40
                    ZIndex: =5

                lblReasonLvlDtST5 As label:
                    Align: =Align.Center
                    BorderThickness: =1
                    Color: =RGBA(255, 255, 255, 1)
                    Fill: =RGBA(71, 158, 245, 1)
                    Height: =60
                    Text: ="Reason*/Level*/Date*"
                    Width: =200
                    X: =663
                    Y: =40
                    ZIndex: =6

                lblRemarksST5 As label:
                    Align: =Align.Center
                    BorderThickness: =1
                    Color: =RGBA(255, 255, 255, 1)
                    Fill: =RGBA(71, 158, 245, 1)
                    Height: =60
                    Text: ="Remarks*"
                    Width: =315
                    X: =863
                    Y: =40
                    ZIndex: =8

                lblNewFICodeST5 As label:
                    Align: =Align.Right
                    BorderThickness: =1
                    Color: =RGBA(15, 84, 140, 1)
                    Fill: =RGBA(180, 214, 250, 1)
                    Height: =30
                    Text: ="New FI Code Requirment "
                    Width: =550
                    X: =13
                    Y: =100
                    ZIndex: =9

                lblCustInfoST5 As label:
                    Align: =Align.Right
                    BorderThickness: =1
                    Color: =RGBA(15, 84, 140, 1)
                    Fill: =RGBA(180, 214, 250, 1)
                    Height: =30
                    PaddingRight: =15
                    Text: ="Information of customer changed to Process (If Secondary change)"
                    Width: =550
                    X: =13
                    Y: =130
                    ZIndex: =10

                lblRMChangeST5 As label:
                    Align: =Align.Right
                    BorderThickness: =1
                    Color: =RGBA(15, 84, 140, 1)
                    Fill: =RGBA(180, 214, 250, 1)
                    Height: =30
                    Text: ="RM change"
                    Width: =550
                    X: =13
                    Y: =160
                    ZIndex: =11

                lblToolDesignST5 As label:
                    Align: =Align.Right
                    BorderThickness: =1
                    Color: =RGBA(15, 84, 140, 1)
                    Fill: =RGBA(180, 214, 250, 1)
                    Height: =30
                    Text: ="Tool design change through PDM system"
                    Width: =550
                    X: =13
                    Y: =190
                    ZIndex: =12

                lblJobOrderST5 As label:
                    Align: =Align.Right
                    BorderThickness: =1
                    Color: =RGBA(15, 84, 140, 1)
                    Fill: =RGBA(180, 214, 250, 1)
                    FontWeight: =FontWeight.Bold
                    Height: =30
                    Text: ="Job order no. need to add (autogenerate through PDM)"
                    Width: =550
                    X: =13
                    Y: =220
                    ZIndex: =13

                lblStageDrawingST5 As label:
                    Align: =Align.Right
                    BorderThickness: =1
                    Color: =RGBA(15, 84, 140, 1)
                    Fill: =RGBA(180, 214, 250, 1)
                    Height: =30
                    Text: ="Stage drawing / FPIR change"
                    Width: =550
                    X: =13
                    Y: =250
                    ZIndex: =14

                chkNewFICodeST5 As checkbox:
                    BorderThickness: =1
                    CheckboxBorderColor: =If(chkNewFICodeST5.Value=false&&chkCustInfoST5.Value=false&&chkRMChangeST5.Value=false&&chkToolDesignST5.Value=false&&chkJobOrderST5.Value=false&&chkStageDrawingST5.Value=false&&varValidationValue=1,Color.Red, RGBA(0, 18, 107, 1))
                    CheckboxSize: =30
                    Default: =If(!IsBlank(VarECN_Stage5),VarECN_Stage5.ES005_NewFICodeRequired,false)
                    DisabledColor: =Color.Black
                    DisplayMode: =If(ctrApprovalST5.Visible||Value(varStageItem)<>5,DisplayMode.Disabled,DisplayMode.Edit)
                    Height: =30
                    OnCheck: =
                    OnSelect: |-
                        =UpdateContext({varReworkchange:1})
                    OnUncheck: =
                    PaddingLeft: =35
                    Reset: =varResetCtrls
                    Text: =
                    Width: =100
                    X: =563
                    Y: =100
                    ZIndex: =25

                chkCustInfoST5 As checkbox:
                    BorderThickness: =1
                    CheckboxBorderColor: =If(chkNewFICodeST5.Value=false&&chkCustInfoST5.Value=false&&chkRMChangeST5.Value=false&&chkToolDesignST5.Value=false&&chkJobOrderST5.Value=false&&chkStageDrawingST5.Value=false&&varValidationValue=1,Color.Red, RGBA(0, 18, 107, 1))
                    CheckboxSize: =30
                    Default: =If(!IsBlank(VarECN_Stage5),VarECN_Stage5.ES005_CustomerChangedToProcess,false)
                    DisabledColor: =Color.Black
                    DisplayMode: =If(ctrApprovalST5.Visible||Value(varStageItem)<>5,DisplayMode.Disabled,DisplayMode.Edit)
                    Height: =30
                    OnSelect: |-
                        =UpdateContext({varReworkchange:1})
                    PaddingLeft: =35
                    Reset: =varResetCtrls
                    Text: =
                    Width: =100
                    X: =563
                    Y: =130
                    ZIndex: =26

                chkRMChangeST5 As checkbox:
                    BorderThickness: =1
                    CheckboxBorderColor: =If(chkNewFICodeST5.Value=false&&chkCustInfoST5.Value=false&&chkRMChangeST5.Value=false&&chkToolDesignST5.Value=false&&chkJobOrderST5.Value=false&&chkStageDrawingST5.Value=false&&varValidationValue=1,Color.Red, RGBA(0, 18, 107, 1))
                    CheckboxSize: =30
                    Default: =If(!IsBlank(VarECN_Stage5),VarECN_Stage5.ES005_RMChange,false)
                    DisabledColor: =Color.Black
                    DisplayMode: =If(ctrApprovalST5.Visible||Value(varStageItem)<>5,DisplayMode.Disabled,DisplayMode.Edit)
                    Height: =30
                    OnSelect: |-
                        =UpdateContext({varReworkchange:1})
                    PaddingLeft: =35
                    Reset: =varResetCtrls
                    Text: =
                    Width: =100
                    X: =563
                    Y: =160
                    ZIndex: =27

                chkToolDesignST5 As checkbox:
                    BorderThickness: =1
                    CheckboxBorderColor: =If(chkNewFICodeST5.Value=false&&chkCustInfoST5.Value=false&&chkRMChangeST5.Value=false&&chkToolDesignST5.Value=false&&chkJobOrderST5.Value=false&&chkStageDrawingST5.Value=false&&varValidationValue=1,Color.Red, RGBA(0, 18, 107, 1))
                    CheckboxSize: =30
                    Default: =If(!IsBlank(VarECN_Stage5),VarECN_Stage5.ES005_ToolDesignChange,false)
                    DisabledColor: =Color.Black
                    DisplayMode: =If(ctrApprovalST5.Visible||Value(varStageItem)<>5,DisplayMode.Disabled,DisplayMode.Edit)
                    Height: =30
                    OnSelect: |-
                        =UpdateContext({varReworkchange:1})
                    PaddingLeft: =35
                    Reset: =varResetCtrls
                    Text: =
                    Width: =100
                    X: =563
                    Y: =190
                    ZIndex: =28

                chkJobOrderST5 As checkbox:
                    BorderThickness: =1
                    CheckboxBorderColor: =If(chkNewFICodeST5.Value=false&&chkCustInfoST5.Value=false&&chkRMChangeST5.Value=false&&chkToolDesignST5.Value=false&&chkJobOrderST5.Value=false&&chkStageDrawingST5.Value=false&&varValidationValue=1,Color.Red, RGBA(0, 18, 107, 1))
                    CheckboxSize: =30
                    Default: =If(!IsBlank(VarECN_Stage5),VarECN_Stage5.ES005_JobOrderNoRequired,false)
                    DisabledColor: =Color.Black
                    DisplayMode: =If(ctrApprovalST5.Visible||Value(varStageItem)<>5,DisplayMode.Disabled,DisplayMode.Edit)
                    Height: =30
                    OnSelect: |-
                        =UpdateContext({varReworkchange:1})
                    PaddingLeft: =35
                    Reset: =varResetCtrls
                    Text: =
                    Width: =100
                    X: =563
                    Y: =220
                    ZIndex: =29

                txtNewFICodeRemarksST5 As text:
                    BorderColor: =If(chkNewFICodeST5.Value=true&&IsBlank(Self.Text)&&varValidationValue=1,Color.Red, RGBA(0, 18, 107, 1))
                    Default: =If(!IsBlank(VarECN_Stage5),VarECN_Stage5.ES005_Remarks,"")
                    DisabledColor: =Color.Black
                    DisplayMode: =If(ctrApprovalST5.Visible||Value(varStageItem)<>5,DisplayMode.Disabled,DisplayMode.Edit)
                    Height: =30
                    OnChange: |-
                        =UpdateContext({varReworkchange:1})
                    RadiusBottomLeft: =0
                    RadiusBottomRight: =0
                    RadiusTopLeft: =0
                    RadiusTopRight: =0
                    Reset: =varResetCtrls
                    Width: =315
                    X: =863
                    Y: =100
                    ZIndex: =35

                txtCustInfoRemarksST5 As text:
                    BorderColor: =If(chkCustInfoST5.Value=true&&IsBlank(Self.Text)&&varValidationValue=1,Color.Red, RGBA(0, 18, 107, 1))
                    Default: =If(!IsBlank(VarECN_Stage5),VarECN_Stage5.ES005_CustomerChangeRemarks,"")
                    DisabledColor: =Color.Black
                    DisplayMode: =If(ctrApprovalST5.Visible||Value(varStageItem)<>5,DisplayMode.Disabled,DisplayMode.Edit)
                    Height: =30
                    OnChange: |-
                        =UpdateContext({varReworkchange:1})
                    RadiusBottomLeft: =0
                    RadiusBottomRight: =0
                    RadiusTopLeft: =0
                    RadiusTopRight: =0
                    Reset: =varResetCtrls
                    Width: =315
                    X: =863
                    Y: =130
                    ZIndex: =36

                txtRMChangeRemarksST5 As text:
                    BorderColor: =If(chkRMChangeST5.Value=true&&IsBlank(Self.Text)&&varValidationValue=1,Color.Red, RGBA(0, 18, 107, 1))
                    Default: =If(!IsBlank(VarECN_Stage5),VarECN_Stage5.ES005_RMChangeRemarks,"")
                    DisabledColor: =Color.Black
                    DisplayMode: =If(ctrApprovalST5.Visible||Value(varStageItem)<>5,DisplayMode.Disabled,DisplayMode.Edit)
                    Height: =30
                    OnChange: |-
                        =UpdateContext({varReworkchange:1})
                    RadiusBottomLeft: =0
                    RadiusBottomRight: =0
                    RadiusTopLeft: =0
                    RadiusTopRight: =0
                    Reset: =varResetCtrls
                    Width: =315
                    X: =863
                    Y: =160
                    ZIndex: =37

                txtToolDesignRemarksST5 As text:
                    BorderColor: =If(chkToolDesignST5.Value=true&&IsBlank(Self.Text)&&varValidationValue=1,Color.Red, RGBA(0, 18, 107, 1))
                    Default: =If(!IsBlank(VarECN_Stage5),VarECN_Stage5.ES005_ToolDesignChangeRemarks,"")
                    DisabledColor: =Color.Black
                    DisplayMode: =If(ctrApprovalST5.Visible||Value(varStageItem)<>5,DisplayMode.Disabled,DisplayMode.Edit)
                    Height: =30
                    OnChange: |-
                        =UpdateContext({varReworkchange:1})
                    RadiusBottomLeft: =0
                    RadiusBottomRight: =0
                    RadiusTopLeft: =0
                    RadiusTopRight: =0
                    Reset: =varResetCtrls
                    Width: =315
                    X: =863
                    Y: =190
                    ZIndex: =38

                txtJobOrderRemarksST5 As text:
                    BorderColor: =If(chkJobOrderST5.Value=true&&IsBlank(Self.Text)&&varValidationValue=1,Color.Red, RGBA(0, 18, 107, 1))
                    Default: =If(!IsBlank(VarECN_Stage5),VarECN_Stage5.ES005_JobOrderNoRemarks,"")
                    DisabledColor: =Color.Black
                    DisplayMode: =If(ctrApprovalST5.Visible||Value(varStageItem)<>5,DisplayMode.Disabled,DisplayMode.Edit)
                    Height: =30
                    OnChange: |-
                        =UpdateContext({varReworkchange:1})
                    RadiusBottomLeft: =0
                    RadiusBottomRight: =0
                    RadiusTopLeft: =0
                    RadiusTopRight: =0
                    Reset: =varResetCtrls
                    Width: =315
                    X: =863
                    Y: =220
                    ZIndex: =39

                chkStageDrawingST5 As checkbox:
                    BorderThickness: =1
                    CheckboxBorderColor: =If(chkNewFICodeST5.Value=false&&chkCustInfoST5.Value=false&&chkRMChangeST5.Value=false&&chkToolDesignST5.Value=false&&chkJobOrderST5.Value=false&&chkStageDrawingST5.Value=false&&varValidationValue=1,Color.Red, RGBA(0, 18, 107, 1))
                    CheckboxSize: =30
                    Default: =If(!IsBlank(VarECN_Stage5),VarECN_Stage5.ES005_StageDrawingFPIRChange,false)
                    DisabledColor: =Color.Black
                    DisplayMode: =If(ctrApprovalST5.Visible||Value(varStageItem)<>5,DisplayMode.Disabled,DisplayMode.Edit)
                    Height: =30
                    OnSelect: |-
                        =UpdateContext({varReworkchange:1})
                    PaddingLeft: =35
                    Reset: =varResetCtrls
                    Text: =
                    Width: =100
                    X: =563
                    Y: =250
                    ZIndex: =48

                txtNewFICodeReasonST5 As text:
                    BorderColor: =If(chkNewFICodeST5.Value=true&&IsBlank(Self.Text)&&varValidationValue=1,Color.Red, RGBA(0, 18, 107, 1))
                    Default: =If(!IsBlank(VarECN_Stage5),VarECN_Stage5.ES005_ReasonForNewCode,"")
                    DisabledColor: =Color.Black
                    DisplayMode: =If(ctrApprovalST5.Visible||Value(varStageItem)<>5,DisplayMode.Disabled,DisplayMode.Edit)
                    Height: =30
                    HintText: ="Provide a reason"
                    OnChange: |-
                        =UpdateContext({varReworkchange:1})
                    RadiusBottomLeft: =0
                    RadiusBottomRight: =0
                    RadiusTopLeft: =0
                    RadiusTopRight: =0
                    Reset: =varResetCtrls
                    Width: =200
                    X: =663
                    Y: =100
                    ZIndex: =49

                ddlLevelST5 As dropdown:
                    AllowEmptySelection: =true
                    BorderColor: =If(chkCustInfoST5.Value=true&&IsBlank(Self.Selected.Value)&&varValidationValue=1,Color.Red, RGBA(0, 18, 107, 1))
                    ChevronBackground: =RGBA(15, 84, 140, 1)
                    Default: =If(!IsBlank(VarECN_Stage5),VarECN_Stage5.ES005_CustomerInfoChangeStatus.Value,"")
                    DisabledColor: =Color.Black
                    DisplayMode: =If(ctrApprovalST5.Visible||Value(varStageItem)<>5,DisplayMode.Disabled,DisplayMode.Edit)
                    Height: =30
                    Items: =Choices(ECN_Stage5.ES005_CustomerInfoChangeStatus)
                    OnChange: |-
                        =UpdateContext({varReworkchange:1})
                    PaddingRight: =9.00
                    PaddingTop: =9.00
                    Reset: =varResetCtrls
                    Size: =11.70
                    Width: =200
                    X: =663
                    Y: =130
                    ZIndex: =50

                dtpRMChangeST5 As datepicker:
                    BorderColor: =If(chkRMChangeST5.Value=true&&IsBlank(Self.SelectedDate)&&varValidationValue=1,Color.Red, RGBA(0, 18, 107, 1))
                    DefaultDate: =If(!IsBlank(VarECN_Stage5),VarECN_Stage5.ES005_RMChangeDate,Blank())
                    DisabledColor: =Color.Black
                    DisplayMode: =If(ctrApprovalST5.Visible||Value(varStageItem)<>5,DisplayMode.Disabled,DisplayMode.Edit)
                    Height: =30
                    InputTextPlaceholder: ="Select a date"
                    OnChange: |-
                        =UpdateContext({varReworkchange:1})
                    Reset: =varResetCtrls
                    Width: =200
                    X: =663
                    Y: =160
                    ZIndex: =51

                dtpToolDesignST5 As datepicker:
                    BorderColor: =If(chkToolDesignST5.Value=true&&IsBlank(Self.SelectedDate)&&varValidationValue=1,Color.Red, RGBA(0, 18, 107, 1))
                    DefaultDate: =If(!IsBlank(VarECN_Stage5),VarECN_Stage5.ES005_ToolDesignChangeDate,Blank())
                    DisabledColor: =Color.Black
                    DisplayMode: =If(ctrApprovalST5.Visible||Value(varStageItem)<>5,DisplayMode.Disabled,DisplayMode.Edit)
                    Height: =30
                    InputTextPlaceholder: ="Select a date"
                    OnChange: |-
                        =UpdateContext({varReworkchange:1})
                    Reset: =varResetCtrls
                    Width: =200
                    X: =663
                    Y: =190
                    ZIndex: =52

                dtpJobOrderST5 As datepicker:
                    BorderColor: =If(chkJobOrderST5.Value=true&&IsBlank(Self.SelectedDate)&&varValidationValue=1,Color.Red, RGBA(0, 18, 107, 1))
                    DefaultDate: =If(!IsBlank(VarECN_Stage5),VarECN_Stage5.ES005_JobOrderNoChangeDate,Blank())
                    DisabledColor: =Color.Black
                    DisplayMode: =If(ctrApprovalST5.Visible||Value(varStageItem)<>5,DisplayMode.Disabled,DisplayMode.Edit)
                    Height: =30
                    InputTextPlaceholder: ="Select a date"
                    OnChange: |-
                        =UpdateContext({varReworkchange:1})
                    Reset: =varResetCtrls
                    Width: =200
                    X: =663
                    Y: =220
                    ZIndex: =53

                dtpStageDrawingST5 As datepicker:
                    BorderColor: =If(chkStageDrawingST5.Value=true&&IsBlank(Self.SelectedDate)&&varValidationValue=1,Color.Red, RGBA(0, 18, 107, 1))
                    DefaultDate: =If(!IsBlank(VarECN_Stage5),VarECN_Stage5.ES005_StageDrawingFPIRChangeDate,Blank())
                    DisabledColor: =Color.Black
                    DisplayMode: =If(ctrApprovalST5.Visible||Value(varStageItem)<>5,DisplayMode.Disabled,DisplayMode.Edit)
                    Height: =30
                    InputTextPlaceholder: ="Select a date"
                    OnChange: |-
                        =UpdateContext({varReworkchange:1})
                    Reset: =varResetCtrls
                    Width: =200
                    X: =663
                    Y: =250
                    ZIndex: =54

                txtStageDrawingRemarksST5 As text:
                    BorderColor: =If(chkStageDrawingST5.Value=true&&IsBlank(Self.Text)&&varValidationValue=1,Color.Red, RGBA(0, 18, 107, 1))
                    Default: =If(!IsBlank(VarECN_Stage5),VarECN_Stage5.ES005_StageDrawingFPIRChangeRemarks,"")
                    DisabledColor: =Color.Black
                    DisplayMode: =If(ctrApprovalST5.Visible||Value(varStageItem)<>5,DisplayMode.Disabled,DisplayMode.Edit)
                    Height: =30
                    OnChange: |-
                        =UpdateContext({varReworkchange:1})
                    RadiusBottomLeft: =0
                    RadiusBottomRight: =0
                    RadiusTopLeft: =0
                    RadiusTopRight: =0
                    Reset: =varResetCtrls
                    Width: =315
                    X: =863
                    Y: =249
                    ZIndex: =55

                ctrApprovalST5 As groupContainer.manualLayoutContainer:
                    BorderThickness: =1
                    Height: =58
                    Visible: |
                        =LookUp(colStageVisibility, StageNumber = 5, Visible)
                    Width: =1166
                    X: =13
                    Y: =338
                    ZIndex: =56

                    lblHdrApprovalST5 As label:
                        BorderThickness: =1
                        Color: =RGBA(255, 255, 255, 1)
                        Fill: =RGBA(71, 158, 245, 1)
                        Height: =58
                        Text: |-
                            ="Changes Approval:-   "
                        Width: =200
                        ZIndex: =1

                    lblCreatedByST5 As label:
                        BorderThickness: =1
                        Fill: =RGBA(71, 158, 245, 1)
                        Height: =30
                        Text: ="Created by"
                        Width: =200
                        X: =200
                        ZIndex: =2

                    txtCreatedByST5 As text:
                        Default: =If(!IsBlank(VarECN_Stage5),LookUp(ECN_UserMaster, User_Id = VarECN_Stage5.ES005_ModifyBy.Value, User_Name)," " )
                        DisplayMode: =DisplayMode.View
                        Height: =30
                        Width: =200
                        X: =200
                        Y: =28
                        ZIndex: =3

                    lblApprovedByST5 As label:
                        BorderThickness: =1
                        Fill: =RGBA(71, 158, 245, 1)
                        Height: =30
                        Text: |-
                            ="Approved By (HOD Engg):"
                        Width: =220
                        X: =400
                        ZIndex: =4

                    txtApprovedByST5 As text:
                        Default: =varUser.User_Name
                        DisplayMode: =DisplayMode.View
                        Height: =30
                        Width: =220
                        X: =400
                        Y: =28
                        ZIndex: =5

                    lblApprovalCommentsST5 As label:
                        BorderThickness: =1
                        Fill: =RGBA(71, 158, 245, 1)
                        Height: =30
                        Text: ="Comments"
                        Width: =547
                        X: =619
                        ZIndex: =6

                    txtApprovalCommentsST5 As text:
                        BorderColor: =If(varValidationValue=1&&IsBlank(Self.Text),Color.Red, RGBA(0, 18, 107, 1))
                        Default: =
                        Height: =30
                        Mode: =TextMode.MultiLine
                        Reset: =varResetCtrls
                        Width: =547
                        X: =619
                        Y: =28
                        ZIndex: =7

                    rdbApprovalST5 As radio:
                        BorderColor: =If(varValidationValue=1&&IsBlank(Self.Selected.Value),Color.Red, RGBA(0, 18, 107, 1))
                        BorderThickness: =1
                        Color: =RGBA(13, 50, 61, 1)
                        Height: =28
                        Items: =["Approve", "Reject", "Rework"]
                        Layout: =Layout.Horizontal
                        PaddingBottom: =0
                        PaddingTop: =1
                        RadioSize: =26
                        Reset: =varResetCtrls
                        Width: =400
                        X: =766
                        Y: =2
                        ZIndex: =8

                lblApproverRemarksST5 As label:
                    Height: =58
                    Text: ="Approver Comments"
                    Visible: =!(LookUp(colStageVisibility, StageNumber = 5, Visible))&&varSelectedECN.Current_Stage_Status.Value="Rework"
                    Width: =214
                    X: =600
                    Y: =305
                    ZIndex: =57

                txtApproverCommentsST5 As text:
                    Default: =VarECN_Stage5.ES005_ApprovalRemark
                    DisplayMode: =DisplayMode.Disabled
                    Visible: =!(LookUp(colStageVisibility, StageNumber = 5, Visible))&&varSelectedECN.Current_Stage_Status.Value="Rework"
                    X: =784
                    Y: =314
                    ZIndex: =58

        FooterContainerST5 As groupContainer.horizontalAutoLayoutContainer:
            Fill: =RGBA(39, 113, 194, 1)
            FillPortions: =0
            Height: =75
            LayoutMinHeight: =100
            LayoutMinWidth: =250
            LayoutMode: =LayoutMode.Auto
            RadiusBottomLeft: =8
            RadiusBottomRight: =8
            RadiusTopLeft: =8
            RadiusTopRight: =8
            ZIndex: =4

            footerST5 As groupContainer.manualLayoutContainer:
                LayoutMinHeight: =75
                LayoutMinWidth: =250
                ZIndex: =1

                btnSubmitST5 As Button:
                    Appearance: ='ButtonCanvas.Appearance'.Primary
                    BasePaletteColor: =
                    BorderColor: =RGBA(255, 255, 255, 1)
                    BorderStyle: =BorderStyle.Solid
                    BorderThickness: =2
                    DisplayMode: =If(Value(varStageItem)<>5,DisplayMode.Disabled,DisplayMode.Edit)
                    Font: =Font.'Segoe UI'
                    FontSize: =20
                    FontStrikethrough: =false
                    Height: =40
                    Icon: ="Save"
                    IconStyle: ='ButtonCanvas.IconStyle'.Outline
                    OnSelect: |-
                        =If(varReworkchange=0&&Text(varSelectedECN.Current_Stage_Status.Value)="Rework",Notify("There is nothing changed on this form, please ensure required changes are done", NotificationType.Warning),
                        UpdateContext({varValidationValue:1});
                        Clear(colValidationST5);
                        If(chkNewFICodeST5.Value=false&&chkCustInfoST5.Value=false&&chkRMChangeST5.Value=false&&chkToolDesignST5.Value=false&&chkJobOrderST5.Value=false&&chkStageDrawingST5.Value=false,
                            Collect(colValidationST5,{value:0}),Collect(colValidationST5,{value:1}));
                        
                        If(chkNewFICodeST5.Value=true&&(IsBlank(txtNewFICodeReasonST5.Text)||IsBlank(txtNewFICodeRemarksST5.Text)),Collect(colValidationST5,{value:0}),Collect(colValidationST5,{value:1}));
                        If(chkCustInfoST5.Value=true&&(IsBlank(ddlLevelST5.Selected.Value)||IsBlank(txtCustInfoRemarksST5.Text)),Collect(colValidationST5,{value:0}),Collect(colValidationST5,{value:1}));
                        If(chkRMChangeST5.Value=true&&(IsBlank(dtpRMChangeST5.SelectedDate)||IsBlank(txtRMChangeRemarksST5.Text)),Collect(colValidationST5,{value:0}),Collect(colValidationST5,{value:1}));
                        If(chkToolDesignST5.Value=true&&(IsBlank(dtpToolDesignST5.SelectedDate)||IsBlank(txtToolDesignRemarksST5.Text)),Collect(colValidationST5,{value:0}),Collect(colValidationST5,{value:1}));
                        If(chkJobOrderST5.Value=true&&(IsBlank(dtpJobOrderST5.SelectedDate)||IsBlank(txtJobOrderRemarksST5.Text)),Collect(colValidationST5,{value:0}),Collect(colValidationST5,{value:1}));
                        If(chkStageDrawingST5.Value=true&&(IsBlank(dtpStageDrawingST5.SelectedDate)||IsBlank(txtStageDrawingRemarksST5.Text)),Collect(colValidationST5,{value:0}),Collect(colValidationST5,{value:1}));
                        If(LookUp(colStageVisibility, StageNumber = 5, Visible)&&(rdbApprovalST5.Selected.Value=Blank()||IsBlank(txtApprovalCommentsST5.Text)),Collect(colValidationST5,{value:0}),Collect(colValidationST5,{value:1}));
                        
                        
                        If(
                            0 in colValidationST5,
                            Notify(
                                "Please fill in all required fields",
                                NotificationType.Error
                        
                            ),  
                            
                            UpdateContext(
                                {
                                    existingRecordST5: LookUp(
                                        ECN_Stage5,
                                        ES005_ECNReference.Value = varSelectedECN.ES001_ECNReference
                                    )
                                }
                            );
                            //collect All approver user id
                        ClearCollect(ColApprovewrEmail,Filter(ColApprover,'ApprovalAccess '=true&&Stage_Id.Value=varStageItem));
                        ClearCollect(coltempId,ForAll(ColApprovewrEmail,{UserId:ThisRecord.User_Id}));
                        Set(VarApproverId,JSON(coltempId,JSONFormat.IncludeBinaryData));
                        
                            If(
                                !IsBlank(existingRecordST5)&&!ctrApprovalST5.Visible,
                                Patch(
                                    ECN_Stage5,
                                    existingRecordST5,
                                    {
                                        Title: varSelectedECN.ES001_ECNReference,
                                        ES005_NewFICodeRequired: chkNewFICodeST5.Value,
                                        ES005_CustomerChangedToProcess: chkCustInfoST5.Value,
                                        ES005_RMChange: chkRMChangeST5.Value,
                                        ES005_ToolDesignChange: chkToolDesignST5.Value,
                                        ES005_JobOrderNoRequired: chkJobOrderST5.Value,
                                        ES005_StageDrawingFPIRChange: chkStageDrawingST5.Value,
                                        ES005_ReasonForNewCode: txtNewFICodeReasonST5.Text,
                                        ES005_RMChangeDate: dtpRMChangeST5.SelectedDate,
                                        ES005_ToolDesignChangeDate: dtpToolDesignST5.SelectedDate,
                                        ES005_JobOrderNoChangeDate: dtpJobOrderST5.SelectedDate,
                                        ES005_StageDrawingFPIRChangeDate: dtpStageDrawingST5.SelectedDate,
                                        ES005_Remarks: txtNewFICodeRemarksST5.Text,
                                        ES005_CustomerChangeRemarks: txtCustInfoRemarksST5.Text,
                                        ES005_RMChangeRemarks: txtRMChangeRemarksST5.Text,
                                        ES005_ToolDesignChangeRemarks: txtToolDesignRemarksST5.Text,
                                        ES005_JobOrderNoRemarks: txtJobOrderRemarksST5.Text,
                                        ES005_StageDrawingFPIRChangeRemarks: txtStageDrawingRemarksST5.Text,
                                        ES005_CustomerInfoChangeStatus:ddlLevelST5.Selected,
                                        ES005_ECNReference: {
                                            Value: varSelectedECN.ES001_ECNReference,
                                            Id: LookUp(
                                                ECN_Stage1,
                                                ES001_ECNReference = varSelectedECN.ES001_ECNReference
                                            ).ID
                                        },
                                        ES005_ModifyBy: {
                                            Value: varUser.User_Name,
                                            Id: LookUp(
                                                ECN_UserMaster,
                                                User_Id = varUser.User_Id
                                            ).ID
                                        }
                                    }
                                ),
                                Patch(
                                    ECN_Stage5,
                                    Defaults(ECN_Stage5),
                                    {
                                        Title: varSelectedECN.ES001_ECNReference,
                                        ES005_NewFICodeRequired: chkNewFICodeST5.Value,
                                        ES005_CustomerChangedToProcess: chkCustInfoST5.Value,
                                        ES005_RMChange: chkRMChangeST5.Value,
                                        ES005_ToolDesignChange: chkToolDesignST5.Value,
                                        ES005_JobOrderNoRequired: chkJobOrderST5.Value,
                                        ES005_StageDrawingFPIRChange: chkStageDrawingST5.Value,
                                        ES005_ReasonForNewCode: txtNewFICodeReasonST5.Text,
                                        ES005_RMChangeDate: dtpRMChangeST5.SelectedDate,
                                        ES005_ToolDesignChangeDate: dtpToolDesignST5.SelectedDate,
                                        ES005_JobOrderNoChangeDate: dtpJobOrderST5.SelectedDate,
                                        ES005_StageDrawingFPIRChangeDate: dtpStageDrawingST5.SelectedDate,
                                        ES005_Remarks: txtNewFICodeRemarksST5.Text,
                                        ES005_CustomerChangeRemarks: txtCustInfoRemarksST5.Text,
                                        ES005_RMChangeRemarks: txtRMChangeRemarksST5.Text,
                                        ES005_ToolDesignChangeRemarks: txtToolDesignRemarksST5.Text,
                                        ES005_JobOrderNoRemarks: txtJobOrderRemarksST5.Text,
                                        ES005_StageDrawingFPIRChangeRemarks: txtStageDrawingRemarksST5.Text,
                                        ES005_CustomerInfoChangeStatus:ddlLevelST5.Selected,
                                        ES005_ECNReference: {
                                            Value: varSelectedECN.ES001_ECNReference,
                                            Id: LookUp(
                                                ECN_Stage1,
                                                ES001_ECNReference = varSelectedECN.ES001_ECNReference
                                            ).ID
                                        },
                                        ES005_ModifyBy: {
                                            Value: varUser.User_Name,
                                            Id: LookUp(
                                                ECN_UserMaster,
                                                User_Id = varUser.User_Id
                                            ).ID
                                        }
                                    }
                                );
                                 // Run stage approval flow
                        
                        'Copyof-Stage2Approval'.Run(
                                        varSelectedECN.ES001_ECNReference,
                                        
                                       LookUp(
                                                ECN_StageMaster,
                                                   Stage_Id = Text(Value(varSelectedECN.ES001_CurrentStage.Value)+1)
                                            ).Stage_Name,
                                        VarApproverId
                                    );
                                );
                        
                           
                            If(
                                !IsEmpty(Errors(ECN_Stage5)),
                                Notify(
                                    "An error occurred while saving the record.",
                                    NotificationType.Error
                                ),
                            // If no errors, proceed with patching ECN_Stage1
                                If(
                                    !IsBlank(existingRecordST5) && ctrApprovalST5.Visible,
                        
                                            Patch(
                                    ECN_Stage5,
                                    existingRecordST5,
                                    {
                                        ES005_ApproveBy: {
                                            Value: varUser.User_Name,
                                            Id: LookUp(
                                                ECN_UserMaster,
                                                User_Id = varUser.User_Id
                                            ).ID
                                        },
                                        ES005_ApprovalRemark: txtApprovalCommentsST5.Text,
                                        ES005_Status: {Value: rdbApprovalST5.Selected.Value},
                                        ES005_ApproveDate: Now()
                                    });
                        
                                    If(
                                        rdbApprovalST5.Selected.Value = "Approve",
                                        Patch(
                                            ECN_Stage1,
                                            LookUp(
                                                ECN_Stage1,
                                                ES001_ECNReference = varSelectedECN.ES001_ECNReference
                                            ),
                                            {
                                                ES001_CurrentStage: {
                                                    Value: "Stage6",
                                                    Id: LookUp(
                                                        ECN_StageMaster,
                                                        Stage_Id = 6
                                                    ).ID
                                                },
                                                Current_Stage_Status: {Value: "New"}
                                            }
                                        ),
                                        Patch(
                                            ECN_Stage1,
                                            LookUp(
                                                ECN_Stage1,
                                                ES001_ECNReference = varSelectedECN.ES001_ECNReference
                                            ),
                                            {
                                                ES001_CurrentStage: {
                                                    Value: "Stage5",
                                                    Id: LookUp(
                                                        ECN_StageMaster,
                                                        Stage_Id = 5
                                                    ).ID
                                                },
                                                Current_Stage_Status: {Value: rdbApprovalST5.Selected.Value}
                                            }
                                        )
                                    ),
                                    Patch(
                                        ECN_Stage1,
                                        LookUp(
                                            ECN_Stage1,
                                            ES001_ECNReference = varSelectedECN.ES001_ECNReference
                                        ),
                                        {
                                            ES001_CurrentStage: {
                                                Value: "Stage5",
                                                Id: LookUp(
                                                    ECN_StageMaster,
                                                    Stage_Id = 5
                                                ).ID
                                            },
                                            Current_Stage_Status: {Value: "Pending"}
                                        }
                                    )
                                );
                                   //Email on latest Status Submit,Rework,Approve and Rejected
                        If(
                                    !IsBlank(rdbApprovalST5.Selected.Value) And LookUp(
                                        colStageVisibility,
                                        StageNumber = 5,
                                        Visible
                                    ),
                                    'Copyof-Submit,Rework,ApproveandRejected'.Run(
                                        LookUp(
                                            ECN_UserMaster,
                                            User_Id=varUser.User_Id
                                        ).Email,
                                        rdbApprovalST5.Selected.Value,
                                        varSelectedECN.ES001_ECNReference,
                                        If(IsBlank(txtApprovalCommentsST5.Text),"",txtApprovalCommentsST5.Text),
                                       If( rdbApprovalST5.Selected.Value = "Approve","Stage6",LookUp(ECN_StageMaster,Stage_Id= varSelectedECN.ES001_CurrentStage.Value).Stage_Name),
                                       If( rdbApprovalST5.Selected.Value = "Approve",6,LookUp(ECN_StageMaster,Stage_Id= varSelectedECN.ES001_CurrentStage.Value).Stage_Id)
                                    ));
                        
                                    //Workflow Patch
                        If(!IsBlank(rdbApprovalST5.Selected.Value)&& LookUp(ECN_UserDetails,User_Id.Value=Text(varUser.User_Id) /*&&!IsBlank(existingRecordST5)*/ && ctrApprovalST5.Visible).'ApprovalAccess ',
                        Patch(ECN_Approval_History,First(Sort(Filter(ECN_Approval_History, ApprHist_ECNno.Value=varSelectedECN.ES001_ECNReference),Created,SortOrder.Descending)),
                        {
                            ApprHist_ECNno:{Id:varSelectedECN.ID,Value:varSelectedECN.ES001_ECNReference},
                            ApprHist_Status:If(rdbApprovalST5.Selected.Value="Rework",{Value:"Rework"},If(rdbApprovalST5.Selected.Value="Approve",{Value:"Approve"},{Value:"Rejected"})),
                            //ApprHist_ProcessedBy:{Id:LookUp(ECN_UserMaster,Email=User().Email).ID,Value:LookUp(ECN_UserMaster,Email=User().Email).Title},
                            ApprHist_ProcessedBy:{
                                            Value: varUser.User_Name,
                                            Id: LookUp(
                                                ECN_UserMaster,
                                                User_Id = varUser.User_Id
                                            ).ID
                                        },
                            ApprHist_ProcessedTime:Now(),
                            ApprHist_Remarks:If(IsBlank(txtApprovalCommentsST5.Text),"",txtApprovalCommentsST5.Text),
                            ApprHist_Stage:If(rdbApprovalST5.Selected.Value="Approve",{
                                            Value: "5",
                                            Id: LookUp(
                                                ECN_StageMaster,
                                                Stage_Id = Text(5)
                                            ).ID
                                        },{
                                            Value: "5",
                                            Id: LookUp(
                                                ECN_StageMaster,
                                                Stage_Id = Text(5)
                                            ).ID
                                        }),
                         
                            ApprHist_RequestedBy: existingRecordST5.ES005_ModifyBy
                                    }
                        
                        
                        
                        
                        ), 
                         Patch(ECN_Approval_History,Defaults(ECN_Approval_History),
                        {
                            ApprHist_ECNno:{Id:varSelectedECN.ID,Value:varSelectedECN.ES001_ECNReference},
                        
                            ApprHist_Stage:If(rdbApprovalST2.Selected.Value="Approve",{
                                            Value: "5",
                                            Id: LookUp(
                                                ECN_StageMaster,
                                                Stage_Id = Text(5)
                                            ).ID
                                        },{
                                            Value: "5",
                                            Id: LookUp(
                                                ECN_StageMaster,
                                                Stage_Id = Text(5)
                                            ).ID
                                        }),
                            
                            ApprHist_RequestedBy:{
                               Id:LookUp(ECN_UserMaster,User_Id = varUser.User_Id).ID,Value:LookUp(ECN_UserMaster,Email=varUser.Email).User_Name},
                                ApprHist_RequestedTime:Now()
                        
                            }
                        
                        
                        
                        
                        )
                        );
                         
                            // Notify success based on the presence of an existing record
                        If(
                                    IsBlank(existingRecordST5),
                                    Notify(
                                        "Record saved successfully!",
                                        NotificationType.Success
                                    ),
                                    Notify(
                                        "Record updated successfully!",
                                        NotificationType.Success
                                    )
                                );
                                // Set this on a Button OnSelect or after the form submission:
                        Reset(chkNewFICodeST5);
                        Reset(chkCustInfoST5);
                        Reset(chkRMChangeST5);
                        Reset(chkToolDesignST5);
                        Reset(chkJobOrderST5);
                        Reset(chkStageDrawingST5);
                        
                        // Reset text inputs
                        Reset(txtNewFICodeReasonST5);
                        Reset(txtNewFICodeRemarksST5);
                        Reset(txtCustInfoRemarksST5);
                        Reset(txtRMChangeRemarksST5);
                        Reset(txtToolDesignRemarksST5);
                        Reset(txtJobOrderRemarksST5);
                        Reset(txtStageDrawingRemarksST5);
                        
                        // Reset date pickers
                        Reset(dtpRMChangeST5);
                        Reset(dtpToolDesignST5);
                        Reset(dtpJobOrderST5);
                        Reset(dtpStageDrawingST5);
                        
                        // Reset dropdown
                        Reset(ddlLevelST5);
                                Navigate(frmHome);
                            )
                          ))
                    Text: ="Submit"
                    VerticalAlign: =VerticalAlign.Middle
                    Width: =140
                    X: =1018
                    Y: =17
                    ZIndex: =1

                btnUpdateST5 As Button:
                    Appearance: ='ButtonCanvas.Appearance'.Primary
                    BasePaletteColor: =
                    BorderColor: =RGBA(255, 255, 255, 1)
                    BorderStyle: =BorderStyle.Solid
                    BorderThickness: =2
                    DisplayMode: =DisplayMode.Edit
                    Font: =Font.'Segoe UI'
                    FontSize: =20
                    FontStrikethrough: =false
                    Height: =40
                    Icon: ="Document"
                    IconStyle: ='ButtonCanvas.IconStyle'.Outline
                    OnSelect: =Navigate(ScreenReport);
                    Text: ="Report"
                    VerticalAlign: =VerticalAlign.Middle
                    Width: =140
                    X: =854
                    Y: =17
                    ZIndex: =2

                btnClearST5 As Button:
                    Appearance: ='ButtonCanvas.Appearance'.Primary
                    BasePaletteColor: =
                    BorderColor: =RGBA(255, 255, 255, 1)
                    BorderStyle: =BorderStyle.Solid
                    BorderThickness: =2
                    DisplayMode: =DisplayMode.Edit
                    Font: =Font.'Segoe UI'
                    FontSize: =20
                    FontStrikethrough: =false
                    Height: =40
                    Icon: ="Eraser"
                    IconStyle: ='ButtonCanvas.IconStyle'.Outline
                    OnSelect: |-
                        =Set(varResetCtrls,true);
                        Set(varResetCtrls,false);
                    Text: ="Clear"
                    VerticalAlign: =VerticalAlign.Middle
                    Width: =140
                    X: =686
                    Y: =17
                    ZIndex: =3

                btnBackST5 As Button:
                    Appearance: ='ButtonCanvas.Appearance'.Primary
                    BasePaletteColor: =
                    BorderColor: =RGBA(255, 255, 255, 1)
                    BorderStyle: =BorderStyle.Solid
                    BorderThickness: =2
                    DisplayMode: =DisplayMode.Edit
                    Font: =Font.'Segoe UI'
                    FontSize: =20
                    FontStrikethrough: =false
                    Height: =40
                    Icon: ="ArrowLeft"
                    IconStyle: ='ButtonCanvas.IconStyle'.Outline
                    OnSelect: |-
                        =
                        
                        Navigate(frmHome)
                    Text: ="Back"
                    VerticalAlign: =VerticalAlign.Middle
                    Width: =140
                    X: =26
                    Y: =17
                    ZIndex: =4

                btnNavigateDummy1_3 As Button:
                    Align: =Align.Left
                    Appearance: ='ButtonCanvas.Appearance'.Primary
                    BasePaletteColor: =
                    BorderColor: =RGBA(255, 255, 255, 1)
                    BorderStyle: =BorderStyle.Solid
                    BorderThickness: =2
                    DisplayMode: =DisplayMode.Edit
                    Font: =Font.'Segoe UI'
                    FontColor: =
                    FontSize: =20
                    FontStrikethrough: =false
                    Height: =40
                    Icon: ="ArrowSort"
                    IconStyle: ='ButtonCanvas.IconStyle'.Outline
                    OnSelect: =
                    Text: ="Navigate"
                    VerticalAlign: =VerticalAlign.Middle
                    Width: =256
                    X: =410
                    Y: =17
                    ZIndex: =5

                ddlNavigateST5 As dropdown:
                    BorderColor: =RGBA(39, 113, 194, 1)
                    ChevronBackground: =RGBA(39, 113, 194, 1)
                    Default: ="Stage 5"
                    Height: =30
                    Items: |
                        =Switch(Value(varStageItem),
                        
                        1,["Stage 1"],
                        2,["Stage 1","Stage 2"],
                        3,["Stage 1","Stage 2","Stage 3"],
                        4,["Stage 1","Stage 2","Stage 3","Stage 4"],
                        5,["Stage 1","Stage 2","Stage 3","Stage 4","Stage 5"],
                        6,["Stage 1","Stage 2","Stage 3","Stage 4","Stage 5","Stage 6"],
                        7,["Stage 1","Stage 2","Stage 3","Stage 4","Stage 5","Stage 6","Stage 7"],
                        8,["Stage 1","Stage 2","Stage 3","Stage 4","Stage 5","Stage 6","Stage 7","Stage 8"],
                        9,["Stage 1","Stage 2","Stage 3","Stage 4","Stage 5","Stage 6","Stage 7","Stage 8","Stage 9"],
                        10,["Stage 1","Stage 2","Stage 3","Stage 4","Stage 5","Stage 6","Stage 7","Stage 8","Stage 9","Stage 10"],
                        11,["Stage 1","Stage 2","Stage 3","Stage 4","Stage 5","Stage 6","Stage 7","Stage 8","Stage 9","Stage 10","Stage 11"],
                        12,["Stage 1","Stage 2","Stage 3","Stage 4","Stage 5","Stage 6","Stage 7","Stage 8","Stage 9","Stage 10","Stage 11","Stage 12"],
                        13,["Stage 1","Stage 2","Stage 3","Stage 4","Stage 5","Stage 6","Stage 7","Stage 8","Stage 9","Stage 10","Stage 11","Stage 12","Stage 13"],
                        14,["Stage 1","Stage 2","Stage 3","Stage 4","Stage 5","Stage 6","Stage 7","Stage 8","Stage 9","Stage 10","Stage 11","Stage 12","Stage 13","Stage 14"],
                        15,["Stage 1","Stage 2","Stage 3","Stage 4","Stage 5","Stage 6","Stage 7","Stage 8","Stage 9","Stage 10","Stage 11","Stage 12","Stage 13","Stage 14","Stage 15"],
                        16,["Stage 1","Stage 2","Stage 3","Stage 4","Stage 5","Stage 6","Stage 7","Stage 8","Stage 9","Stage 10","Stage 11","Stage 12","Stage 13","Stage 14","Stage 15","Stage 16"],[""])
                    OnChange: |
                        =Switch(Self.Selected.Value,
                        "Stage 1",Navigate(frmST1),
                        "Stage 2",Navigate(frmST2),
                        "Stage 3",Navigate(frmST3),
                        "Stage 4",Navigate(frmST4),
                        "Stage 5",Navigate(frmST5),
                        "Stage 6",Navigate(frmST6),
                        "Stage 7",Navigate(frmST7),
                        "Stage 8",Navigate(frmST8),
                        "Stage 9",Navigate(frmST9),
                        "Stage 10",Navigate(frmST10),
                        "Stage 11",Navigate(frmST11),
                        "Stage 12",Navigate(frmST12),
                        "Stage 13",Navigate(frmST13),
                        "Stage 14",Navigate(frmST14),
                        "Stage 15",Navigate(frmST15),
                        "Stage 16",Navigate(frmST15)
                        
                        )
                    PaddingRight: =9.00
                    PaddingTop: =9.00
                    Reset: =true
                    Size: =11.70
                    Width: =118
                    X: =538
                    Y: =22
                    ZIndex: =6

                btnViewWorkflow_2 As Button:
                    Appearance: ='ButtonCanvas.Appearance'.Primary
                    BasePaletteColor: =
                    BorderColor: =RGBA(255, 255, 255, 1)
                    BorderStyle: =BorderStyle.Solid
                    BorderThickness: =2
                    DisplayMode: =DisplayMode.Edit
                    Font: =Font.'Segoe UI'
                    FontSize: =20
                    FontStrikethrough: =false
                    Height: =40
                    Icon: ="Eye"
                    IconStyle: ='ButtonCanvas.IconStyle'.Outline
                    OnSelect: |
                        =UpdateContext({VarViewWorkflow:!VarViewWorkflow});
                        If(VarViewWorkflow,btnNavigateDummy1.Visible=false;,btnNavigateDummy1.Visible=true;);
                    Text: =If(VarViewWorkflow,"Apr History Hide","Apr History Show")
                    VerticalAlign: =VerticalAlign.Middle
                    Visible: =(CountRows(Gallery1_2.AllItems)>0)
                    Width: =216
                    X: =180
                    Y: =17
                    ZIndex: =7

    PopupContainer_5 As groupContainer.verticalAutoLayoutContainer:
        Fill: =RGBA(200, 200, 200, 0.8)
        Height: =740
        LayoutDirection: =LayoutDirection.Vertical
        LayoutMode: =LayoutMode.Auto
        Visible: =If(varLogoutPopup=1,true,false)
        Width: =1200
        X: =15
        Y: =15
        ZIndex: =2

        Popup_5 As groupContainer.manualLayoutContainer:
            LayoutMinHeight: =100
            LayoutMinWidth: =250
            ZIndex: =1

            btnPopupBack_5 As button:
                DisabledColor: =RGBA(0, 0, 0, 1)
                DisplayMode: =DisplayMode.Disabled
                Fill: =RGBA(255, 255, 255, 1)
                Height: =188
                Size: =11
                Text: ="Are you sure to logout?"
                Width: =347
                X: =755
                Y: =95
                ZIndex: =2

            btnPopupTop_5 As button:
                DisabledColor: =RGBA(255, 255, 255, 1)
                DisabledFill: =RGBA(39, 113, 194, 1)
                DisplayMode: =DisplayMode.Disabled
                RadiusBottomLeft: =0
                RadiusBottomRight: =0
                Size: =13
                Text: ="Confirm Logout"
                Width: =347
                X: =755
                Y: =95
                ZIndex: =5

            btnPopupBottom_5 As button:
                DisabledFill: =RGBA(214, 221, 224, 1)
                DisplayMode: =DisplayMode.Disabled
                Fill: =RGBA(214, 221, 224, 1)
                RadiusTopLeft: =00
                RadiusTopRight: =0
                Text: =
                Width: =347
                X: =755
                Y: =243
                ZIndex: =6

            btnPopupYes_5 As button:
                Fill: =RGBA(132, 40, 38, 1)
                Height: =30
                HoverFill: =ColorFade(Self.Fill, -20%)
                OnSelect: |-
                    =Set(varUser, Blank());
                    Clear(colStageIDs);
                    Navigate(frmLogin);
                    UpdateContext({varLogoutPopup:0});
                Size: =12
                Text: ="Yes"
                Width: =95
                X: =822
                Y: =248
                ZIndex: =7

            btnPopupNo_5 As button:
                Fill: =RGBA(39, 113, 194, 1)
                Height: =30
                HoverFill: =ColorFade(Self.Fill, -20%)
                OnSelect: |-
                    =UpdateContext({varLogoutPopup:0});
                Size: =12
                Text: ="No"
                Width: =95
                X: =940
                Y: =248
                ZIndex: =8

    IconCloseApproverHistoryST2_1 As icon.CancelBadge:
        Height: =30
        Icon: =Icon.CancelBadge
        OnSelect: |-
            =UpdateContext({VarViewWorkflow:!VarViewWorkflow})
        Visible: =VarViewWorkflow
        Width: =50
        X: =1179
        Y: =102
        ZIndex: =5

    Group_popUp_ApproverHistory_1 As group:
        Height: =5
        Width: =5
        X: =40
        Y: =20
        ZIndex: =5

        Container_popup_2 As groupContainer.manualLayoutContainer:
            Height: =577
            Visible: =VarViewWorkflow
            Width: =1229
            Y: =96
            ZIndex: =3

            "Gallery1_2 As gallery.'BrowseLayout_Vertical_TwoTextOneImageVariant_ver5.0'":
                DelayItemLoading: =true
                Fill: =RGBA(255, 255, 255, 1)
                Height: =503
                Items: |
                    =SortByColumns(Filter(ECN_Approval_History,ApprHist_ECNno.Value=varSelectedECN.ES001_ECNReference && ApprHist_Stage.Value =Text(LookUp(ECN_StageMaster,Stage_Id = varSelectedECN.ES001_CurrentStage.Value).Stage_Id) && !IsBlank(ApprHist_Status.Value)),"Created",SortOrder.Ascending)
                Layout: =Layout.Vertical
                LoadingSpinner: =LoadingSpinner.Data
                TemplatePadding: =0
                TemplateSize: =67
                Width: =1229
                Y: =74
                ZIndex: =1

                Container2_4 As groupContainer.horizontalAutoLayoutContainer:
                    Height: =64
                    LayoutAlignItems: =LayoutAlignItems.Stretch
                    LayoutMode: =LayoutMode.Auto
                    Width: =1229
                    ZIndex: =15

                    "'Text_ ECN_No_4' As Text":
                        Align: ='TextCanvas.Align'.Center
                        AutoHeight: =true
                        DisplayMode: =DisplayMode.Edit
                        FillPortions: =1
                        Height: =32
                        LayoutMinHeight: =32
                        LayoutMinWidth: =96
                        Text: =ThisItem.ApprHist_ECNno.Value
                        Width: =96
                        X: =89
                        Y: =32
                        ZIndex: =1

                    "'Text_ Status_4' As Text":
                        Align: ='TextCanvas.Align'.Center
                        AutoHeight: =true
                        DisplayMode: =DisplayMode.Edit
                        FillPortions: =1
                        Height: =32
                        LayoutMinHeight: =32
                        LayoutMinWidth: =80
                        Text: =ThisItem.ApprHist_Status.Value
                        Width: =90
                        X: =40
                        Y: =40
                        ZIndex: =2

                    "'Text_ Requested_By_4' As Text":
                        Align: ='TextCanvas.Align'.Center
                        AutoHeight: =true
                        DisplayMode: =DisplayMode.Edit
                        FillPortions: =1
                        Height: =32
                        LayoutMinHeight: =32
                        LayoutMinWidth: =96
                        Text: =LookUp(ECN_UserMaster,User_Id= Value(ThisItem.ApprHist_RequestedBy.Value),User_Name)
                        Width: =96
                        X: =20
                        Y: =20
                        ZIndex: =3

                    "'Text_ Request_Time_4' As Text":
                        Align: ='TextCanvas.Align'.Center
                        AutoHeight: =true
                        DisplayMode: =DisplayMode.Edit
                        FillPortions: =1
                        Height: =32
                        LayoutMinHeight: =32
                        LayoutMinWidth: =96
                        Text: =ThisItem.ApprHist_RequestedTime
                        Width: =96
                        X: =40
                        Y: =32
                        ZIndex: =4

                    "'Text_ Processed_By_4' As Text":
                        Align: ='TextCanvas.Align'.Center
                        AutoHeight: =true
                        DisplayMode: =DisplayMode.Edit
                        FillPortions: =1
                        Height: =32
                        LayoutMinHeight: =32
                        LayoutMinWidth: =96
                        Text: =LookUp(ECN_UserMaster,User_Id= Value(ThisItem.ApprHist_ProcessedBy.Value),User_Name)
                        Width: =96
                        X: =60
                        Y: =32
                        ZIndex: =5

                    "'Text_ Processed_Time_4' As Text":
                        Align: ='TextCanvas.Align'.Center
                        AutoHeight: =true
                        DisplayMode: =DisplayMode.Edit
                        FillPortions: =1
                        Height: =32
                        LayoutMinHeight: =32
                        LayoutMinWidth: =96
                        Text: =ThisItem.ApprHist_ProcessedTime
                        Width: =96
                        X: =80
                        Y: =32
                        ZIndex: =6

                    Text_Remark_4 As Text:
                        Align: ='TextCanvas.Align'.Center
                        AutoHeight: =true
                        DisplayMode: =DisplayMode.Edit
                        FillPortions: =1
                        Height: =32
                        LayoutMinHeight: =32
                        LayoutMinWidth: =96
                        Text: =ThisItem.ApprHist_Remarks
                        Width: =96
                        X: =100
                        Y: =32
                        ZIndex: =7

        Container2_5 As groupContainer.horizontalAutoLayoutContainer:
            Fill: =RGBA(255, 255, 255, 1)
            Height: =76
            LayoutAlignItems: =LayoutAlignItems.Stretch
            LayoutMode: =LayoutMode.Auto
            Visible: =VarViewWorkflow
            Width: =1229
            Y: =96
            ZIndex: =4

            "'Text_ ECN_No_5' As Text":
                Align: ='TextCanvas.Align'.Center
                AlignInContainer: =AlignInContainer.Center
                AutoHeight: =true
                DisplayMode: =DisplayMode.Edit
                FillPortions: =1
                Height: =32
                LayoutMinHeight: =32
                LayoutMinWidth: =96
                Size: =20
                Text: ="ECN No"
                Weight: ='TextCanvas.Weight'.Bold
                Width: =96
                X: =89
                Y: =32
                ZIndex: =1

            "'Text_ Status_5' As Text":
                Align: ='TextCanvas.Align'.Center
                AlignInContainer: =AlignInContainer.Center
                AutoHeight: =true
                DisplayMode: =DisplayMode.Edit
                FillPortions: =1
                Height: =32
                LayoutMinHeight: =32
                LayoutMinWidth: =100
                Size: =20
                Text: ="Status"
                Weight: ='TextCanvas.Weight'.Bold
                Width: =100
                X: =40
                Y: =40
                ZIndex: =2

            "'Text_ Requested_By_5' As Text":
                Align: ='TextCanvas.Align'.Center
                AlignInContainer: =AlignInContainer.Center
                AutoHeight: =true
                DisplayMode: =DisplayMode.Edit
                FillPortions: =1
                Height: =32
                LayoutMinHeight: =32
                LayoutMinWidth: =96
                Size: =20
                Text: ="Requested By"
                Weight: ='TextCanvas.Weight'.Bold
                Width: =96
                X: =20
                Y: =20
                ZIndex: =3

            "'Text_ Request_Time_5' As Text":
                Align: ='TextCanvas.Align'.Center
                AlignInContainer: =AlignInContainer.Center
                AutoHeight: =true
                DisplayMode: =DisplayMode.Edit
                FillPortions: =1
                Height: =32
                LayoutMinHeight: =32
                LayoutMinWidth: =96
                Size: =20
                Text: ="Requested Time"
                Weight: ='TextCanvas.Weight'.Bold
                Width: =96
                X: =40
                Y: =32
                ZIndex: =4

            "'Text_ Processed_By_5' As Text":
                Align: ='TextCanvas.Align'.Center
                AlignInContainer: =AlignInContainer.Center
                AutoHeight: =true
                DisplayMode: =DisplayMode.Edit
                FillPortions: =1
                Height: =32
                LayoutMinHeight: =32
                LayoutMinWidth: =96
                Size: =20
                Text: ="Processed By"
                Weight: ='TextCanvas.Weight'.Bold
                Width: =96
                X: =60
                Y: =32
                ZIndex: =5

            "'Text_ Processed_Time_5' As Text":
                Align: ='TextCanvas.Align'.Center
                AlignInContainer: =AlignInContainer.Center
                AutoHeight: =true
                DisplayMode: =DisplayMode.Edit
                FillPortions: =1
                Height: =32
                LayoutMinHeight: =32
                LayoutMinWidth: =96
                Size: =20
                Text: ="Processed Time"
                Weight: ='TextCanvas.Weight'.Bold
                Width: =96
                X: =80
                Y: =32
                ZIndex: =6

            Text_Remark_5 As Text:
                Align: ='TextCanvas.Align'.Center
                AlignInContainer: =AlignInContainer.Center
                AutoHeight: =true
                DisplayMode: =DisplayMode.Edit
                FillPortions: =1
                Height: =32
                LayoutMinHeight: =32
                LayoutMinWidth: =96
                Size: =20
                Text: ="Remarks"
                Weight: ='TextCanvas.Weight'.Bold
                Width: =96
                X: =100
                Y: =32
                ZIndex: =7

